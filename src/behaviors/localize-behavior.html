<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-document.html">

<script>
  (function () {
    'use strict';

    HOVERBOARD.LocalizeBehaviorImpl = {

      listeners: {
        'app-resources-loaded': '_onLocalesLoaded'
      },

      observers: [
        '_setResources(app.lang, app.resources)'
      ],

      _setResources: function(lang, resources) {
        if (!resources || !resources[lang]) {
          return;
        }

        if (!this.resources || !this.resources[lang]) {
          this.set('language', lang);
          this.set('resources', resources);
        }
        this.fire('app-resources-loaded');

      },

      _onLocalesLoaded: function (event) {
        event.stopPropagation();
        this.set('language', this.app.lang);
      }
    };

    HOVERBOARD.LocalizeBehavior = [
      Polymer.AppLocalizeBehavior,
      HOVERBOARD.LocalizeBehaviorImpl
    ];

  }());
</script>
